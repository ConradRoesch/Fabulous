<!doctype html><html lang=en-us><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="ie=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><link rel=preload as=font href=https://fsprojects.github.io/Fabulous/fonts/vendor/jost/jost-v4-latin-regular.woff2 type=font/woff2 crossorigin><link rel=preload as=font href=https://fsprojects.github.io/Fabulous/fonts/vendor/jost/jost-v4-latin-500.woff2 type=font/woff2 crossorigin><link rel=preload as=font href=https://fsprojects.github.io/Fabulous/fonts/vendor/jost/jost-v4-latin-700.woff2 type=font/woff2 crossorigin><script>(()=>{var b=window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches,a=localStorage.getItem("theme");b&&a===null&&(localStorage.setItem("theme","dark"),document.documentElement.setAttribute("data-dark-mode","")),b&&a==="dark"&&document.documentElement.setAttribute("data-dark-mode",""),a==="dark"&&document.documentElement.setAttribute("data-dark-mode","")})()</script><link rel=stylesheet href=https://fsprojects.github.io/Fabulous/main.b19695a4a00fc78ffb031b659403c3ccb9fb5b02553cd29bdf01fbd29d30ac24386d927d97999a3a6a81aa63d13682d2fb04094d9ba89c559a3082785ff91f06.css integrity="sha512-sZaVpKAPx4/7AxtllAPDzLn7WwJVPNKb3wH70p0wrCQ4bZJ9l5maOmqBqmPRNoLS+wQJTZuonFWaMIJ4X/kfBg==" crossorigin=anonymous><noscript><style>img.lazyload{display:none}</style></noscript><meta name=robots content="index, follow"><meta name=googlebot content="index, follow, max-snippet:-1, max-image-preview:large, max-video-preview:-1"><meta name=bingbot content="index, follow, max-snippet:-1, max-image-preview:large, max-video-preview:-1"><title>The Init and Update Functions - Fabulous</title><meta name=description content="The init function returns an initial model, and the update function processes a message and returns a new model:
type Model = { TimerOn: bool } type Message = | TimerToggled of bool let init () = { TimerOn = false } let update msg model = match msg with | TimerToggled on -&amp;gt; { model with TimerOn = on }  Commands # A command (type Cmd) is a callback that can dispatch messages, i."><link rel=canonical href=https://fsprojects.github.io/Fabulous/docs/v1/tutorials/update/><meta property="og:locale" content="en_US"><meta property="og:type" content="article"><meta property="og:title" content="The Init and Update Functions"><meta property="og:description" content="The init function returns an initial model, and the update function processes a message and returns a new model:
type Model = { TimerOn: bool } type Message = | TimerToggled of bool let init () = { TimerOn = false } let update msg model = match msg with | TimerToggled on -> { model with TimerOn = on }  Commands # A command (type Cmd) is a callback that can dispatch messages, i."><meta property="og:url" content="https://fsprojects.github.io/Fabulous/docs/v1/tutorials/update/"><meta property="og:site_name" content="Fabulous"><meta property="article:published_time" content="2022-03-31T00:00:00+00:00"><meta property="article:modified_time" content="2022-03-31T00:00:00+00:00"><meta property="og:image" content="https://fsprojects.github.io/Fabulous/fabulous.png"><meta property="og:image:alt" content="Fabulous"><meta name=twitter:card content="summary_large_image"><meta name=twitter:site content="@Tim_Lariviere"><meta name=twitter:creator content="@Tim_Lariviere"><meta name=twitter:title content="The Init and Update Functions"><meta name=twitter:description content><meta name=twitter:image content="https://fsprojects.github.io/Fabulous/fabulous.png"><meta name=twitter:image:alt content="The Init and Update Functions"><script type=application/ld+json>{"@context":"https://schema.org","@graph":[{"@type":"Organization","@id":"https://fsprojects.github.io/#/schema/organization/1","name":"Fabulous","url":"https://fsprojects.github.io/","sameAs":["https://twitter.com/Tim_Lariviere","https://github.com/Tim_Lariviere/Fabulous-new"],"logo":{"@type":"ImageObject","@id":"https://fsprojects.github.io/#/schema/image/1","url":"https://fsprojects.github.io/logo-fabulous.png","width":512,"height":512,"caption":"Fabulous"},"image":{"@id":"https://fsprojects.github.io/#/schema/image/1"}},{"@type":"WebSite","@id":"https://fsprojects.github.io/#/schema/website/1","url":"https://fsprojects.github.io/","name":"Fabulous","description":"Fabulous allows you to combine the power of functional programming and the simple Model-View-Update architecture to build any kind of mobile and desktop applications with an expressive, dynamic and clean UI DSL.","publisher":{"@id":"https://fsprojects.github.io/#/schema/organization/1"}},{"@type":"WebPage","@id":"https://fsprojects.github.io/Fabulous/docs/v1/tutorials/update/","url":"https://fsprojects.github.io/Fabulous/docs/v1/tutorials/update/","name":"The Init and Update Functions","description":"","isPartOf":{"@id":"https://fsprojects.github.io/#/schema/website/1"},"about":{"@id":"https://fsprojects.github.io/#/schema/organization/1"},"datePublished":"2022-03-31T00:00:00CET","dateModified":"2022-03-31T00:00:00CET","breadcrumb":{"@id":"https://fsprojects.github.io/Fabulous/docs/v1/tutorials/update/#/schema/breadcrumb/1"},"primaryImageOfPage":{"@id":"https://fsprojects.github.io/Fabulous/docs/v1/tutorials/update/#/schema/image/2"},"inLanguage":"en-US","potentialAction":[{"@type":"ReadAction","target":["https://fsprojects.github.io/Fabulous/docs/v1/tutorials/update/"]}]},{"@type":"BreadcrumbList","@id":"https://fsprojects.github.io/Fabulous/docs/v1/tutorials/update/#/schema/breadcrumb/1","name":"Breadcrumbs","itemListElement":[{"@type":"ListItem","position":1,"item":{"@type":"WebPage","@id":"https://fsprojects.github.io/Fabulous/","url":"https://fsprojects.github.io/Fabulous/","name":"Home"}},{"@type":"ListItem","position":2,"item":{"@type":"WebPage","@id":"https://fsprojects.github.io/Fabulous/docs/","url":"https://fsprojects.github.io/Fabulous/docs/","name":"Docs"}},{"@type":"ListItem","position":3,"item":{"@type":"WebPage","@id":"https://fsprojects.github.io/Fabulous/docs/v1/","url":"https://fsprojects.github.io/Fabulous/docs/v1/","name":"V1"}},{"@type":"ListItem","position":4,"item":{"@type":"WebPage","@id":"https://fsprojects.github.io/Fabulous/docs/v1/tutorials/","url":"https://fsprojects.github.io/Fabulous/docs/v1/tutorials/","name":"Tutorials"}},{"@type":"ListItem","position":5,"item":{"@id":"https://fsprojects.github.io/Fabulous/docs/v1/tutorials/update/"}}]},{"@context":"https://schema.org","@graph":[{"@type":"Article","@id":"https://fsprojects.github.io/#/schema/article/1","headline":"The Init and Update Functions","description":"","isPartOf":{"@id":"https://fsprojects.github.io/Fabulous/docs/v1/tutorials/update/"},"mainEntityOfPage":{"@id":"https://fsprojects.github.io/Fabulous/docs/v1/tutorials/update/"},"datePublished":"2022-03-31T00:00:00CET","dateModified":"2022-03-31T00:00:00CET","author":{"@id":"https://fsprojects.github.io/#/schema/person/2"},"publisher":{"@id":"https://fsprojects.github.io/#/schema/organization/1"},"image":{"@id":"https://fsprojects.github.io/Fabulous/docs/v1/tutorials/update/#/schema/image/2"}}]},{"@context":"https://schema.org","@graph":[{"@type":"Person","@id":"https://fsprojects.github.io/#/schema/person/2","name":"Timothé Larivière","sameAs":["https://twitter.com/Tim_Lariviere","https://www.linkedin.com/in/timlariviere/","https://github.com/TimLariviere"]}]},{"@context":"https://schema.org","@graph":[{"@type":"ImageObject","@id":"https://fsprojects.github.io/Fabulous/docs/v1/tutorials/update/#/schema/image/2","url":"https://fsprojects.github.io/Fabulous/fabulous.png","contentUrl":"https://fsprojects.github.io/Fabulous/fabulous.png","caption":"The Init and Update Functions"}]}]}</script><meta name=theme-color content="#fff"><link rel=apple-touch-icon sizes=180x180 href=https://fsprojects.github.io/Fabulous/apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=https://fsprojects.github.io/Fabulous/favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=https://fsprojects.github.io/Fabulous/favicon-16x16.png><link rel=manifest crossorigin=use-credentials href=https://fsprojects.github.io/Fabulous/site.webmanifest></head><body class="docs single"><div class=header-bar></div><header class="navbar navbar-expand-md navbar-light doks-navbar"><nav class="container-xxl flex-wrap flex-md-nowrap" aria-label="Main navigation"><a class="navbar-brand p-0 me-auto" href=https://fsprojects.github.io/Fabulous/ aria-label=Fabulous>Fabulous</a>
<button class="btn btn-menu d-block d-md-none order-5" type=button data-bs-toggle=offcanvas data-bs-target=#offcanvasDoks aria-controls=offcanvasDoks aria-label="Open main menu"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-menu"><line x1="3" y1="12" x2="21" y2="12"/><line x1="3" y1="6" x2="21" y2="6"/><line x1="3" y1="18" x2="21" y2="18"/></svg></button><div class="offcanvas offcanvas-start border-0 py-md-1" tabindex=-1 id=offcanvasDoks data-bs-backdrop=true aria-labelledby=offcanvasDoksLabel><div class="header-bar d-md-none"></div><div class="offcanvas-header d-md-none"><h2 class="h5 offcanvas-title ps-2" id=offcanvasDoksLabel><a class=text-dark href=https://fsprojects.github.io/Fabulous/>Fabulous</a></h2><button type=button class="btn-close text-reset me-2" data-bs-dismiss=offcanvas aria-label="Close main menu"></button></div><div class="offcanvas-body px-4"><h3 class="h6 text-uppercase mb-3 d-md-none">Main</h3><ul class="nav flex-column flex-md-row ms-md-n3"><li class=nav-item><a class="nav-link ps-0 py-1 active" href=https://fsprojects.github.io/Fabulous/docs/about/fabulous-for-xamarinforms/>Docs</a></li><li class=nav-item><a class="nav-link ps-0 py-1" href=https://fsprojects.github.io/Fabulous/blog/>Blog</a></li><li class="nav-item dropdown"><a class="nav-link dropdown-toggle ps-0 py-1" href=# id=navbarDropdownMenuLink role=button data-bs-toggle=dropdown aria-expanded=false>Get Started
<span class=dropdown-caret><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-chevron-down"><polyline points="6 9 12 15 18 9"/></svg></span></a><ul class="dropdown-menu dropdown-menu-main shadow rounded border-0" aria-labelledby=navbarDropdownMenuLink><li><a class=dropdown-item href=https://fsprojects.github.io/Fabulous/docs/quickstarts/>Quickstarts</a></li><li><a class=dropdown-item href=https://fsprojects.github.io/Fabulous/docs/tutorials/>Tutorials</a></li></ul></li></ul><hr class="text-black-50 my-4 d-md-none"><h3 class="h6 text-uppercase mb-3 d-md-none">Socials</h3><ul class="nav flex-column flex-md-row ms-md-auto me-md-n5 pe-md-2"><li class=nav-item><a class="nav-link ps-0 py-1" href=https://github.com/TimLariviere/Fabulous-new><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-github"><path d="M9 19c-5 1.5-5-2.5-7-3m14 6v-3.87a3.37 3.37.0 00-.94-2.61c3.14-.35 6.44-1.54 6.44-7A5.44 5.44.0 0020 4.77 5.07 5.07.0 0019.91 1S18.73.65 16 2.48a13.38 13.38.0 00-7 0C6.27.65 5.09 1 5.09 1A5.07 5.07.0 005 4.77 5.44 5.44.0 003.5 8.55c0 5.42 3.3 6.61 6.44 7A3.37 3.37.0 009 18.13V22"/></svg><small class="ms-2 d-md-none">GitHub</small></a></li><li class=nav-item><a class="nav-link ps-0 py-1" href=https://twitter.com/Tim_Lariviere><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-twitter"><path d="M23 3a10.9 10.9.0 01-3.14 1.53 4.48 4.48.0 00-7.86 3v1A10.66 10.66.0 013 4s-4 9 5 13a11.64 11.64.0 01-7 2c9 5 20 0 20-11.5a4.5 4.5.0 00-.08-.83A7.72 7.72.0 0023 3z"/></svg><small class="ms-2 d-md-none">Twitter</small></a></li></ul></div></div><button id=mode class="btn btn-link order-md-1" type=button aria-label="Toggle user interface mode">
<span class=toggle-dark><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-moon"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg></span><span class=toggle-light><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-sun"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></span></button></nav></header><nav class="doks-subnavbar py-2 sticky-lg-top" aria-label="Secondary navigation"><div class="container-xxl d-flex align-items-md-center"><form class="doks-search position-relative flex-grow-1 me-auto"><input id=search class="form-control is-search" type=search placeholder="Search docs..." aria-label="Search docs..." autocomplete=off><div id=suggestions class="shadow bg-white rounded d-none"></div></form><button class="btn doks-sidebar-toggle d-lg-none ms-3 order-3 collapsed" type=button data-bs-toggle=collapse data-bs-target=#doks-docs-nav aria-controls=doks-docs-nav aria-expanded=false aria-label="Toggle documentation navigation"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" class="doks doks-expand" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><title>Expand</title><polyline points="7 13 12 18 17 13"/><polyline points="7 6 12 11 17 6"/></svg><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" class="doks doks-collapse" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><title>Collapse</title><polyline points="17 11 12 6 7 11"/><polyline points="17 18 12 13 7 18"/></svg></button></div></nav><div class=container-xxl><aside class=doks-sidebar><nav id=doks-docs-nav class="collapse d-lg-none" aria-label="Tertiary navigation"><ul class="list-unstyled collapsible-sidebar"><li class=mb-1><button class="btn btn-toggle align-items-center rounded collapsed" data-bs-toggle=collapse data-bs-target=#section-46b3931b9959c927df4fc65fdee94b07 aria-expanded=false>
About</button><div class=collapse id=section-46b3931b9959c927df4fc65fdee94b07><ul class="btn-toggle-nav list-unstyled fw-normal pb-1 small"><li><a class="docs-link rounded" href=https://fsprojects.github.io/Fabulous/docs/about/fabulous-for-xamarinforms/>Fabulous for Xamarin.Forms</a></li><li><a class="docs-link rounded" href=https://fsprojects.github.io/Fabulous/docs/about/fabulous-staticview/>Fabulous.StaticView (deprecated)</a></li><li><a class="docs-link rounded" href=https://fsprojects.github.io/Fabulous/docs/about/they-use-fabulous/>They use Fabulous</a></li></ul></div></li><li class=mb-1><button class="btn btn-toggle align-items-center rounded collapsed" data-bs-toggle=collapse data-bs-target=#section-6654c734ccab8f440ff0825eb443dc7f aria-expanded=true>
Version 1</button><div class="collapse show" id=section-6654c734ccab8f440ff0825eb443dc7f><ul class="btn-toggle-nav list-unstyled fw-normal pb-1 small"><li><a class="docs-link rounded" href=https://fsprojects.github.io/Fabulous/docs/v1/getting-started/>Getting started</a></li><li class="my-1 ms-3"><button class="btn btn-toggle align-items-center rounded collapsed" data-bs-toggle=collapse data-bs-target=#section-a4d1982d45a8df888848781b1b4774e7 aria-expanded=true>
Tutorials</button><div class="collapse show" id=section-a4d1982d45a8df888848781b1b4774e7><ul class="btn-toggle-nav list-unstyled fw-normal pb-1 small"><li><a class="docs-link rounded" href=https://fsprojects.github.io/Fabulous/docs/v1/tutorials/how-to/>How to write your own extensions</a></li><li><a class="docs-link rounded" href=https://fsprojects.github.io/Fabulous/docs/v1/tutorials/model/>Models</a></li><li><a class="docs-link rounded" href=https://fsprojects.github.io/Fabulous/docs/v1/tutorials/mvu/>MVU</a></li><li><a class="docs-link rounded" href=https://fsprojects.github.io/Fabulous/docs/v1/tutorials/dev-pitfalls/>Pitfalls and F# 5.0 support</a></li><li><a class="docs-link rounded" href=https://fsprojects.github.io/Fabulous/docs/v1/tutorials/dev-testing/>Testing</a></li><li><a class="docs-link rounded active" href=https://fsprojects.github.io/Fabulous/docs/v1/tutorials/update/>The Init and Update Functions</a></li><li><a class="docs-link rounded" href=https://fsprojects.github.io/Fabulous/docs/v1/tutorials/dev-logging/>Traces and crashes</a></li><li><a class="docs-link rounded" href=https://fsprojects.github.io/Fabulous/docs/v1/tutorials/dev-tools/>Using the Fabulous command line</a></li><li><a class="docs-link rounded" href=https://fsprojects.github.io/Fabulous/docs/v1/tutorials/view/>Views</a></li></ul></div></li><li class="my-1 ms-3"><button class="btn btn-toggle align-items-center rounded collapsed" data-bs-toggle=collapse data-bs-target=#section-3e57f996a3aea1880033d283d256a07a aria-expanded=false>
API Reference</button><div class=collapse id=section-3e57f996a3aea1880033d283d256a07a><ul class="btn-toggle-nav list-unstyled fw-normal pb-1 small"><li class="my-1 ms-3"><button class="btn btn-toggle align-items-center rounded collapsed" data-bs-toggle=collapse data-bs-target=#section-a456323b78d9c122f7f82472cfcaa555 aria-expanded=false>
Controls</button><div class=collapse id=section-a456323b78d9c122f7f82472cfcaa555><ul class="btn-toggle-nav list-unstyled fw-normal pb-1 small"><li><a class="docs-link rounded" href=https://fsprojects.github.io/Fabulous/docs/v1/api/controls/activityindicator/>ActivityIndicator</a></li><li><a class="docs-link rounded" href=https://fsprojects.github.io/Fabulous/docs/v1/api/controls/boxview/>BoxView</a></li><li><a class="docs-link rounded" href=https://fsprojects.github.io/Fabulous/docs/v1/api/controls/button/>Button</a></li><li><a class="docs-link rounded" href=https://fsprojects.github.io/Fabulous/docs/v1/api/controls/carouselpage/>CarouselPage</a></li><li><a class="docs-link rounded" href=https://fsprojects.github.io/Fabulous/docs/v1/api/controls/carouselview/>CarouselView</a></li><li><a class="docs-link rounded" href=https://fsprojects.github.io/Fabulous/docs/v1/api/controls/checkbox/>Checkbox</a></li><li><a class="docs-link rounded" href=https://fsprojects.github.io/Fabulous/docs/v1/api/controls/collectionview/>CollectionView</a></li><li><a class="docs-link rounded" href=https://fsprojects.github.io/Fabulous/docs/v1/api/controls/contentpage/>ContentPage</a></li><li><a class="docs-link rounded" href=https://fsprojects.github.io/Fabulous/docs/v1/api/controls/datepicker/>DatePicker</a></li><li><a class="docs-link rounded" href=https://fsprojects.github.io/Fabulous/docs/v1/api/controls/editor/>Editor</a></li><li><a class="docs-link rounded" href=https://fsprojects.github.io/Fabulous/docs/v1/api/controls/ellipse/>Ellipse</a></li><li><a class="docs-link rounded" href=https://fsprojects.github.io/Fabulous/docs/v1/api/controls/entry/>Entry</a></li><li><a class="docs-link rounded" href=https://fsprojects.github.io/Fabulous/docs/v1/api/controls/flyoutpage/>FlyoutPage</a></li><li><a class="docs-link rounded" href=https://fsprojects.github.io/Fabulous/docs/v1/api/controls/gestures/>Gestures</a></li><li><a class="docs-link rounded" href=https://fsprojects.github.io/Fabulous/docs/v1/api/controls/image/>Image</a></li><li><a class="docs-link rounded" href=https://fsprojects.github.io/Fabulous/docs/v1/api/controls/imagebutton/>ImageButton</a></li><li><a class="docs-link rounded" href=https://fsprojects.github.io/Fabulous/docs/v1/api/controls/indicatorview/>IndicatorView</a></li><li><a class="docs-link rounded" href=https://fsprojects.github.io/Fabulous/docs/v1/api/controls/label/>Label</a></li><li><a class="docs-link rounded" href=https://fsprojects.github.io/Fabulous/docs/v1/api/controls/layouts/>Layouts</a></li><li><a class="docs-link rounded" href=https://fsprojects.github.io/Fabulous/docs/v1/api/controls/line/>Line</a></li><li><a class="docs-link rounded" href=https://fsprojects.github.io/Fabulous/docs/v1/api/controls/listview/>ListView and ListViewGrouped</a></li><li><a class="docs-link rounded" href=https://fsprojects.github.io/Fabulous/docs/v1/api/controls/navigationpage/>NavigationPage</a></li><li><a class="docs-link rounded" href=https://fsprojects.github.io/Fabulous/docs/v1/api/controls/openglview/>OpenGLView</a></li><li><a class="docs-link rounded" href=https://fsprojects.github.io/Fabulous/docs/v1/api/controls/path/>Path</a></li><li><a class="docs-link rounded" href=https://fsprojects.github.io/Fabulous/docs/v1/api/controls/picker/>Picker</a></li><li><a class="docs-link rounded" href=https://fsprojects.github.io/Fabulous/docs/v1/api/controls/polygon/>Polygon</a></li><li><a class="docs-link rounded" href=https://fsprojects.github.io/Fabulous/docs/v1/api/controls/polyline/>Polyline</a></li><li><a class="docs-link rounded" href=https://fsprojects.github.io/Fabulous/docs/v1/api/controls/progressbar/>ProgressBar</a></li><li><a class="docs-link rounded" href=https://fsprojects.github.io/Fabulous/docs/v1/api/controls/radiobutton/>RadioButton</a></li><li><a class="docs-link rounded" href=https://fsprojects.github.io/Fabulous/docs/v1/api/controls/rectangle/>Rectangle</a></li><li><a class="docs-link rounded" href=https://fsprojects.github.io/Fabulous/docs/v1/api/controls/refreshview/>RefreshVIew</a></li><li><a class="docs-link rounded" href=https://fsprojects.github.io/Fabulous/docs/v1/api/controls/searchbar/>SearchBar</a></li><li><a class="docs-link rounded" href=https://fsprojects.github.io/Fabulous/docs/v1/api/controls/shell/>Shell</a></li><li><a class="docs-link rounded" href=https://fsprojects.github.io/Fabulous/docs/v1/api/controls/slider/>Slider</a></li><li><a class="docs-link rounded" href=https://fsprojects.github.io/Fabulous/docs/v1/api/controls/stepper/>Stepper</a></li><li><a class="docs-link rounded" href=https://fsprojects.github.io/Fabulous/docs/v1/api/controls/styling/>Styling</a></li><li><a class="docs-link rounded" href=https://fsprojects.github.io/Fabulous/docs/v1/api/controls/swipeview/>SwipeView</a></li><li><a class="docs-link rounded" href=https://fsprojects.github.io/Fabulous/docs/v1/api/controls/switch/>Switch</a></li><li><a class="docs-link rounded" href=https://fsprojects.github.io/Fabulous/docs/v1/api/controls/tabbedpage/>TabbedPage</a></li><li><a class="docs-link rounded" href=https://fsprojects.github.io/Fabulous/docs/v1/api/controls/tableview/>TableView</a></li><li><a class="docs-link rounded" href=https://fsprojects.github.io/Fabulous/docs/v1/api/controls/timepicker/>TimePicker</a></li><li><a class="docs-link rounded" href=https://fsprojects.github.io/Fabulous/docs/v1/api/controls/webview/>WebView</a></li></ul></div></li><li><a class="docs-link rounded" href=https://fsprojects.github.io/Fabulous/docs/v1/api/animations/>Animations</a></li><li><a class="docs-link rounded" href=https://fsprojects.github.io/Fabulous/docs/v1/api/custom-renderer/>Custom renderers and Custom controls</a></li><li><a class="docs-link rounded" href=https://fsprojects.github.io/Fabulous/docs/v1/api/effects/>Effects</a></li><li><a class="docs-link rounded" href=https://fsprojects.github.io/Fabulous/docs/v1/api/codegen-bindings/>Fabulous.CodeGen</a></li><li><a class="docs-link rounded" href=https://fsprojects.github.io/Fabulous/docs/v1/api/navigation/>Navigation</a></li><li><a class="docs-link rounded" href=https://fsprojects.github.io/Fabulous/docs/v1/api/popups/>Pop-ups</a></li><li><a class="docs-link rounded" href=https://fsprojects.github.io/Fabulous/docs/v1/api/performance/>View and performance</a></li></ul></div></li><li class="my-1 ms-3"><button class="btn btn-toggle align-items-center rounded collapsed" data-bs-toggle=collapse data-bs-target=#section-3dc8be706a69216224c91c2bee37d0f9 aria-expanded=false>
Extensions</button><div class=collapse id=section-3dc8be706a69216224c91c2bee37d0f9><ul class="btn-toggle-nav list-unstyled fw-normal pb-1 small"><li><a class="docs-link rounded" href=https://fsprojects.github.io/Fabulous/docs/v1/extensions/ffimageloading/>FFImageLoading</a></li><li><a class="docs-link rounded" href=https://fsprojects.github.io/Fabulous/docs/v1/extensions/oxyplot/>OxyPlot</a></li><li><a class="docs-link rounded" href=https://fsprojects.github.io/Fabulous/docs/v1/extensions/skiasharp/>SkiaSharp</a></li><li><a class="docs-link rounded" href=https://fsprojects.github.io/Fabulous/docs/v1/extensions/videomanager/>VideoManager</a></li><li><a class="docs-link rounded" href=https://fsprojects.github.io/Fabulous/docs/v1/extensions/xamarinforms-maps/>Xamarin.Forms.Maps</a></li></ul></div></li></ul></div></li><li class=mb-1><button class="btn btn-toggle align-items-center rounded collapsed" data-bs-toggle=collapse data-bs-target=#section-1b267619c4812cc46ee281747884ca50 aria-expanded=false>
Version 2</button><div class=collapse id=section-1b267619c4812cc46ee281747884ca50><ul class="btn-toggle-nav list-unstyled fw-normal pb-1 small"><li><a class="docs-link rounded" href=https://fsprojects.github.io/Fabulous/docs/v2/getting-started/>Getting started</a></li><li class="my-1 ms-3"><button class="btn btn-toggle align-items-center rounded collapsed" data-bs-toggle=collapse data-bs-target=#section-5027704fbba052221b8192c347dd324b aria-expanded=false>
Tutorials</button><div class=collapse id=section-5027704fbba052221b8192c347dd324b><ul class="btn-toggle-nav list-unstyled fw-normal pb-1 small"><li><a class="docs-link rounded" href=https://fsprojects.github.io/Fabulous/docs/v2/tutorials/using-nightly-builds/>Using nightly builds</a></li></ul></div></li><li class="my-1 ms-3"><button class="btn btn-toggle align-items-center rounded collapsed" data-bs-toggle=collapse data-bs-target=#section-ee970452eef2feb3434e4db493978a7a aria-expanded=false>
API Reference</button><div class=collapse id=section-ee970452eef2feb3434e4db493978a7a><ul class="btn-toggle-nav list-unstyled fw-normal pb-1 small"><li class="my-1 ms-3"><button class="btn btn-toggle align-items-center rounded collapsed" data-bs-toggle=collapse data-bs-target=#section-f2e7ce0d9a84a2a9dafb13341470c18f aria-expanded=false>
Controls</button><div class=collapse id=section-f2e7ce0d9a84a2a9dafb13341470c18f><ul class="btn-toggle-nav list-unstyled fw-normal pb-1 small"><li><a class="docs-link rounded" href=https://fsprojects.github.io/Fabulous/docs/v2/api/controls/button/>Button</a></li><li><a class="docs-link rounded" href=https://fsprojects.github.io/Fabulous/docs/v2/api/controls/element/>Element</a></li><li><a class="docs-link rounded" href=https://fsprojects.github.io/Fabulous/docs/v2/api/controls/label/>Label</a></li><li><a class="docs-link rounded" href=https://fsprojects.github.io/Fabulous/docs/v2/api/controls/navigableelement/>NavigableElement</a></li><li><a class="docs-link rounded" href=https://fsprojects.github.io/Fabulous/docs/v2/api/controls/view/>View</a></li><li><a class="docs-link rounded" href=https://fsprojects.github.io/Fabulous/docs/v2/api/controls/visualelement/>VisualElement</a></li></ul></div></li></ul></div></li><li class="my-1 ms-3"><button class="btn btn-toggle align-items-center rounded collapsed" data-bs-toggle=collapse data-bs-target=#section-d6dc8e34ffb16d208f2777e5c6b23062 aria-expanded=false>
Architecture</button><div class=collapse id=section-d6dc8e34ffb16d208f2777e5c6b23062><ul class="btn-toggle-nav list-unstyled fw-normal pb-1 small"><li><a class="docs-link rounded" href=https://fsprojects.github.io/Fabulous/docs/v2/architecture/goals-of-v2/>Reasonable goals of v2</a></li><li><a class="docs-link rounded" href=https://fsprojects.github.io/Fabulous/docs/v2/architecture/virtualized-collections/>Virtualized collections</a></li></ul></div></li></ul></div></li></ul></nav></aside></div><div class="wrap container-xxl" role=document><div class=content><div class="row flex-xl-nowrap"><div class="col-lg-5 col-xl-4 docs-sidebar d-none d-lg-block"><nav class=docs-links aria-label="Main navigation"><ul class="list-unstyled collapsible-sidebar"><li class=mb-1><button class="btn btn-toggle align-items-center rounded collapsed" data-bs-toggle=collapse data-bs-target=#section-46b3931b9959c927df4fc65fdee94b07 aria-expanded=false>
About</button><div class=collapse id=section-46b3931b9959c927df4fc65fdee94b07><ul class="btn-toggle-nav list-unstyled fw-normal pb-1 small"><li><a class="docs-link rounded" href=https://fsprojects.github.io/Fabulous/docs/about/fabulous-for-xamarinforms/>Fabulous for Xamarin.Forms</a></li><li><a class="docs-link rounded" href=https://fsprojects.github.io/Fabulous/docs/about/fabulous-staticview/>Fabulous.StaticView (deprecated)</a></li><li><a class="docs-link rounded" href=https://fsprojects.github.io/Fabulous/docs/about/they-use-fabulous/>They use Fabulous</a></li></ul></div></li><li class=mb-1><button class="btn btn-toggle align-items-center rounded collapsed" data-bs-toggle=collapse data-bs-target=#section-6654c734ccab8f440ff0825eb443dc7f aria-expanded=true>
Version 1</button><div class="collapse show" id=section-6654c734ccab8f440ff0825eb443dc7f><ul class="btn-toggle-nav list-unstyled fw-normal pb-1 small"><li><a class="docs-link rounded" href=https://fsprojects.github.io/Fabulous/docs/v1/getting-started/>Getting started</a></li><li class="my-1 ms-3"><button class="btn btn-toggle align-items-center rounded collapsed" data-bs-toggle=collapse data-bs-target=#section-a4d1982d45a8df888848781b1b4774e7 aria-expanded=true>
Tutorials</button><div class="collapse show" id=section-a4d1982d45a8df888848781b1b4774e7><ul class="btn-toggle-nav list-unstyled fw-normal pb-1 small"><li><a class="docs-link rounded" href=https://fsprojects.github.io/Fabulous/docs/v1/tutorials/how-to/>How to write your own extensions</a></li><li><a class="docs-link rounded" href=https://fsprojects.github.io/Fabulous/docs/v1/tutorials/model/>Models</a></li><li><a class="docs-link rounded" href=https://fsprojects.github.io/Fabulous/docs/v1/tutorials/mvu/>MVU</a></li><li><a class="docs-link rounded" href=https://fsprojects.github.io/Fabulous/docs/v1/tutorials/dev-pitfalls/>Pitfalls and F# 5.0 support</a></li><li><a class="docs-link rounded" href=https://fsprojects.github.io/Fabulous/docs/v1/tutorials/dev-testing/>Testing</a></li><li><a class="docs-link rounded active" href=https://fsprojects.github.io/Fabulous/docs/v1/tutorials/update/>The Init and Update Functions</a></li><li><a class="docs-link rounded" href=https://fsprojects.github.io/Fabulous/docs/v1/tutorials/dev-logging/>Traces and crashes</a></li><li><a class="docs-link rounded" href=https://fsprojects.github.io/Fabulous/docs/v1/tutorials/dev-tools/>Using the Fabulous command line</a></li><li><a class="docs-link rounded" href=https://fsprojects.github.io/Fabulous/docs/v1/tutorials/view/>Views</a></li></ul></div></li><li class="my-1 ms-3"><button class="btn btn-toggle align-items-center rounded collapsed" data-bs-toggle=collapse data-bs-target=#section-3e57f996a3aea1880033d283d256a07a aria-expanded=false>
API Reference</button><div class=collapse id=section-3e57f996a3aea1880033d283d256a07a><ul class="btn-toggle-nav list-unstyled fw-normal pb-1 small"><li class="my-1 ms-3"><button class="btn btn-toggle align-items-center rounded collapsed" data-bs-toggle=collapse data-bs-target=#section-a456323b78d9c122f7f82472cfcaa555 aria-expanded=false>
Controls</button><div class=collapse id=section-a456323b78d9c122f7f82472cfcaa555><ul class="btn-toggle-nav list-unstyled fw-normal pb-1 small"><li><a class="docs-link rounded" href=https://fsprojects.github.io/Fabulous/docs/v1/api/controls/activityindicator/>ActivityIndicator</a></li><li><a class="docs-link rounded" href=https://fsprojects.github.io/Fabulous/docs/v1/api/controls/boxview/>BoxView</a></li><li><a class="docs-link rounded" href=https://fsprojects.github.io/Fabulous/docs/v1/api/controls/button/>Button</a></li><li><a class="docs-link rounded" href=https://fsprojects.github.io/Fabulous/docs/v1/api/controls/carouselpage/>CarouselPage</a></li><li><a class="docs-link rounded" href=https://fsprojects.github.io/Fabulous/docs/v1/api/controls/carouselview/>CarouselView</a></li><li><a class="docs-link rounded" href=https://fsprojects.github.io/Fabulous/docs/v1/api/controls/checkbox/>Checkbox</a></li><li><a class="docs-link rounded" href=https://fsprojects.github.io/Fabulous/docs/v1/api/controls/collectionview/>CollectionView</a></li><li><a class="docs-link rounded" href=https://fsprojects.github.io/Fabulous/docs/v1/api/controls/contentpage/>ContentPage</a></li><li><a class="docs-link rounded" href=https://fsprojects.github.io/Fabulous/docs/v1/api/controls/datepicker/>DatePicker</a></li><li><a class="docs-link rounded" href=https://fsprojects.github.io/Fabulous/docs/v1/api/controls/editor/>Editor</a></li><li><a class="docs-link rounded" href=https://fsprojects.github.io/Fabulous/docs/v1/api/controls/ellipse/>Ellipse</a></li><li><a class="docs-link rounded" href=https://fsprojects.github.io/Fabulous/docs/v1/api/controls/entry/>Entry</a></li><li><a class="docs-link rounded" href=https://fsprojects.github.io/Fabulous/docs/v1/api/controls/flyoutpage/>FlyoutPage</a></li><li><a class="docs-link rounded" href=https://fsprojects.github.io/Fabulous/docs/v1/api/controls/gestures/>Gestures</a></li><li><a class="docs-link rounded" href=https://fsprojects.github.io/Fabulous/docs/v1/api/controls/image/>Image</a></li><li><a class="docs-link rounded" href=https://fsprojects.github.io/Fabulous/docs/v1/api/controls/imagebutton/>ImageButton</a></li><li><a class="docs-link rounded" href=https://fsprojects.github.io/Fabulous/docs/v1/api/controls/indicatorview/>IndicatorView</a></li><li><a class="docs-link rounded" href=https://fsprojects.github.io/Fabulous/docs/v1/api/controls/label/>Label</a></li><li><a class="docs-link rounded" href=https://fsprojects.github.io/Fabulous/docs/v1/api/controls/layouts/>Layouts</a></li><li><a class="docs-link rounded" href=https://fsprojects.github.io/Fabulous/docs/v1/api/controls/line/>Line</a></li><li><a class="docs-link rounded" href=https://fsprojects.github.io/Fabulous/docs/v1/api/controls/listview/>ListView and ListViewGrouped</a></li><li><a class="docs-link rounded" href=https://fsprojects.github.io/Fabulous/docs/v1/api/controls/navigationpage/>NavigationPage</a></li><li><a class="docs-link rounded" href=https://fsprojects.github.io/Fabulous/docs/v1/api/controls/openglview/>OpenGLView</a></li><li><a class="docs-link rounded" href=https://fsprojects.github.io/Fabulous/docs/v1/api/controls/path/>Path</a></li><li><a class="docs-link rounded" href=https://fsprojects.github.io/Fabulous/docs/v1/api/controls/picker/>Picker</a></li><li><a class="docs-link rounded" href=https://fsprojects.github.io/Fabulous/docs/v1/api/controls/polygon/>Polygon</a></li><li><a class="docs-link rounded" href=https://fsprojects.github.io/Fabulous/docs/v1/api/controls/polyline/>Polyline</a></li><li><a class="docs-link rounded" href=https://fsprojects.github.io/Fabulous/docs/v1/api/controls/progressbar/>ProgressBar</a></li><li><a class="docs-link rounded" href=https://fsprojects.github.io/Fabulous/docs/v1/api/controls/radiobutton/>RadioButton</a></li><li><a class="docs-link rounded" href=https://fsprojects.github.io/Fabulous/docs/v1/api/controls/rectangle/>Rectangle</a></li><li><a class="docs-link rounded" href=https://fsprojects.github.io/Fabulous/docs/v1/api/controls/refreshview/>RefreshVIew</a></li><li><a class="docs-link rounded" href=https://fsprojects.github.io/Fabulous/docs/v1/api/controls/searchbar/>SearchBar</a></li><li><a class="docs-link rounded" href=https://fsprojects.github.io/Fabulous/docs/v1/api/controls/shell/>Shell</a></li><li><a class="docs-link rounded" href=https://fsprojects.github.io/Fabulous/docs/v1/api/controls/slider/>Slider</a></li><li><a class="docs-link rounded" href=https://fsprojects.github.io/Fabulous/docs/v1/api/controls/stepper/>Stepper</a></li><li><a class="docs-link rounded" href=https://fsprojects.github.io/Fabulous/docs/v1/api/controls/styling/>Styling</a></li><li><a class="docs-link rounded" href=https://fsprojects.github.io/Fabulous/docs/v1/api/controls/swipeview/>SwipeView</a></li><li><a class="docs-link rounded" href=https://fsprojects.github.io/Fabulous/docs/v1/api/controls/switch/>Switch</a></li><li><a class="docs-link rounded" href=https://fsprojects.github.io/Fabulous/docs/v1/api/controls/tabbedpage/>TabbedPage</a></li><li><a class="docs-link rounded" href=https://fsprojects.github.io/Fabulous/docs/v1/api/controls/tableview/>TableView</a></li><li><a class="docs-link rounded" href=https://fsprojects.github.io/Fabulous/docs/v1/api/controls/timepicker/>TimePicker</a></li><li><a class="docs-link rounded" href=https://fsprojects.github.io/Fabulous/docs/v1/api/controls/webview/>WebView</a></li></ul></div></li><li><a class="docs-link rounded" href=https://fsprojects.github.io/Fabulous/docs/v1/api/animations/>Animations</a></li><li><a class="docs-link rounded" href=https://fsprojects.github.io/Fabulous/docs/v1/api/custom-renderer/>Custom renderers and Custom controls</a></li><li><a class="docs-link rounded" href=https://fsprojects.github.io/Fabulous/docs/v1/api/effects/>Effects</a></li><li><a class="docs-link rounded" href=https://fsprojects.github.io/Fabulous/docs/v1/api/codegen-bindings/>Fabulous.CodeGen</a></li><li><a class="docs-link rounded" href=https://fsprojects.github.io/Fabulous/docs/v1/api/navigation/>Navigation</a></li><li><a class="docs-link rounded" href=https://fsprojects.github.io/Fabulous/docs/v1/api/popups/>Pop-ups</a></li><li><a class="docs-link rounded" href=https://fsprojects.github.io/Fabulous/docs/v1/api/performance/>View and performance</a></li></ul></div></li><li class="my-1 ms-3"><button class="btn btn-toggle align-items-center rounded collapsed" data-bs-toggle=collapse data-bs-target=#section-3dc8be706a69216224c91c2bee37d0f9 aria-expanded=false>
Extensions</button><div class=collapse id=section-3dc8be706a69216224c91c2bee37d0f9><ul class="btn-toggle-nav list-unstyled fw-normal pb-1 small"><li><a class="docs-link rounded" href=https://fsprojects.github.io/Fabulous/docs/v1/extensions/ffimageloading/>FFImageLoading</a></li><li><a class="docs-link rounded" href=https://fsprojects.github.io/Fabulous/docs/v1/extensions/oxyplot/>OxyPlot</a></li><li><a class="docs-link rounded" href=https://fsprojects.github.io/Fabulous/docs/v1/extensions/skiasharp/>SkiaSharp</a></li><li><a class="docs-link rounded" href=https://fsprojects.github.io/Fabulous/docs/v1/extensions/videomanager/>VideoManager</a></li><li><a class="docs-link rounded" href=https://fsprojects.github.io/Fabulous/docs/v1/extensions/xamarinforms-maps/>Xamarin.Forms.Maps</a></li></ul></div></li></ul></div></li><li class=mb-1><button class="btn btn-toggle align-items-center rounded collapsed" data-bs-toggle=collapse data-bs-target=#section-1b267619c4812cc46ee281747884ca50 aria-expanded=false>
Version 2</button><div class=collapse id=section-1b267619c4812cc46ee281747884ca50><ul class="btn-toggle-nav list-unstyled fw-normal pb-1 small"><li><a class="docs-link rounded" href=https://fsprojects.github.io/Fabulous/docs/v2/getting-started/>Getting started</a></li><li class="my-1 ms-3"><button class="btn btn-toggle align-items-center rounded collapsed" data-bs-toggle=collapse data-bs-target=#section-5027704fbba052221b8192c347dd324b aria-expanded=false>
Tutorials</button><div class=collapse id=section-5027704fbba052221b8192c347dd324b><ul class="btn-toggle-nav list-unstyled fw-normal pb-1 small"><li><a class="docs-link rounded" href=https://fsprojects.github.io/Fabulous/docs/v2/tutorials/using-nightly-builds/>Using nightly builds</a></li></ul></div></li><li class="my-1 ms-3"><button class="btn btn-toggle align-items-center rounded collapsed" data-bs-toggle=collapse data-bs-target=#section-ee970452eef2feb3434e4db493978a7a aria-expanded=false>
API Reference</button><div class=collapse id=section-ee970452eef2feb3434e4db493978a7a><ul class="btn-toggle-nav list-unstyled fw-normal pb-1 small"><li class="my-1 ms-3"><button class="btn btn-toggle align-items-center rounded collapsed" data-bs-toggle=collapse data-bs-target=#section-f2e7ce0d9a84a2a9dafb13341470c18f aria-expanded=false>
Controls</button><div class=collapse id=section-f2e7ce0d9a84a2a9dafb13341470c18f><ul class="btn-toggle-nav list-unstyled fw-normal pb-1 small"><li><a class="docs-link rounded" href=https://fsprojects.github.io/Fabulous/docs/v2/api/controls/button/>Button</a></li><li><a class="docs-link rounded" href=https://fsprojects.github.io/Fabulous/docs/v2/api/controls/element/>Element</a></li><li><a class="docs-link rounded" href=https://fsprojects.github.io/Fabulous/docs/v2/api/controls/label/>Label</a></li><li><a class="docs-link rounded" href=https://fsprojects.github.io/Fabulous/docs/v2/api/controls/navigableelement/>NavigableElement</a></li><li><a class="docs-link rounded" href=https://fsprojects.github.io/Fabulous/docs/v2/api/controls/view/>View</a></li><li><a class="docs-link rounded" href=https://fsprojects.github.io/Fabulous/docs/v2/api/controls/visualelement/>VisualElement</a></li></ul></div></li></ul></div></li><li class="my-1 ms-3"><button class="btn btn-toggle align-items-center rounded collapsed" data-bs-toggle=collapse data-bs-target=#section-d6dc8e34ffb16d208f2777e5c6b23062 aria-expanded=false>
Architecture</button><div class=collapse id=section-d6dc8e34ffb16d208f2777e5c6b23062><ul class="btn-toggle-nav list-unstyled fw-normal pb-1 small"><li><a class="docs-link rounded" href=https://fsprojects.github.io/Fabulous/docs/v2/architecture/goals-of-v2/>Reasonable goals of v2</a></li><li><a class="docs-link rounded" href=https://fsprojects.github.io/Fabulous/docs/v2/architecture/virtualized-collections/>Virtualized collections</a></li></ul></div></li></ul></div></li></ul></nav></div><nav class="docs-toc d-none d-xl-block col-xl-3" aria-label="Secondary navigation"><div class=page-links><h3>On this page</h3><nav id=TableOfContents><ul><li><a href=#commands>Commands</a></li><li><a href=#triggering-commands-on-initialization>Triggering Commands on Initialization</a></li><li><a href=#triggering-commands-as-messages-are-processed>Triggering Commands as Messages are Processed</a></li><li><a href=#triggering-commands-from-external-events>Triggering Commands from External Events</a></li><li><a href=#replacing-commands-with-command-messages-for-better-testability>Replacing commands with command messages for better testability</a></li><li><a href=#threading-and-long-running-operations>Threading and Long-running Operations</a></li><li><a href=#optional-commands>Optional commands</a></li><li><a href=#webrequests-in-a-command>Webrequests in a Command</a></li><li><a href=#platform-specific-dispatch>Platform-specific dispatch</a></li></ul></nav></div></nav><main class="docs-content col-lg-11 col-xl-9"><h1>The Init and Update Functions</h1><p class=lead></p><nav class=d-xl-none aria-label="Quaternary navigation"><div class=page-links><h3>On this page</h3><nav id=TableOfContents><ul><li><a href=#commands>Commands</a></li><li><a href=#triggering-commands-on-initialization>Triggering Commands on Initialization</a></li><li><a href=#triggering-commands-as-messages-are-processed>Triggering Commands as Messages are Processed</a></li><li><a href=#triggering-commands-from-external-events>Triggering Commands from External Events</a></li><li><a href=#replacing-commands-with-command-messages-for-better-testability>Replacing commands with command messages for better testability</a></li><li><a href=#threading-and-long-running-operations>Threading and Long-running Operations</a></li><li><a href=#optional-commands>Optional commands</a></li><li><a href=#webrequests-in-a-command>Webrequests in a Command</a></li><li><a href=#platform-specific-dispatch>Platform-specific dispatch</a></li></ul></nav></div></nav><p>The init function returns an initial model, and the update function processes a message and returns a new model:</p><pre><code class=language-fs>type Model = { TimerOn: bool } 

type Message = 
    | TimerToggled of bool
    
let init () = { TimerOn = false }
    
let update msg model =
    match msg with
    | TimerToggled on -&gt; { model with TimerOn = on }
</code></pre><h2 id=commands>Commands <a href=#commands class=anchor aria-hidden=true>#</a></h2><p>A command (type <code>Cmd</code>) is a callback that can dispatch messages, i.e. gets access to <code>dispatch</code> when run.</p><p>Commands can be used for event subscriptions to callback, implement timers and so on. They can also be returned
with the model to queue up long running operations such as network calls.</p><p>Commands are often asynchronous and nearly always dispatch messages. For example, the simplest way to make a command
is <code>Cmd.ofAsyncMsg</code> which triggers a message dispatch when an async completes:</p><pre><code class=language-fs>let timerCmd = 
    async { do! Async.Sleep 200
            return TimedTick }
    |&gt; Cmd.ofAsyncMsg
</code></pre><h2 id=triggering-commands-on-initialization>Triggering Commands on Initialization <a href=#triggering-commands-on-initialization class=anchor aria-hidden=true>#</a></h2><p>The <code>init</code> function may trigger commands, e.g. initial database requests. This is permitted when using <code>Program.mkProgram</code>.
For example here is a pattern to get an initial balance on startup:</p><pre><code class=language-fs>let fetchInitialBalance = Cmd.ofAsyncMsg (async { ... })

let init () = { ... }, fetchInitialBalance
</code></pre><h2 id=triggering-commands-as-messages-are-processed>Triggering Commands as Messages are Processed <a href=#triggering-commands-as-messages-are-processed class=anchor aria-hidden=true>#</a></h2><p>The <code>update</code> function may trigger commands such as timers. This is permitted when using <code>Program.mkProgram</code>.
For example, here is one pattern for a timer loop that can be turned on/off:</p><pre><code class=language-fs>type Model = 
    { TimerOn: bool
      Count: int
      Step: int }
        
type Message = 
    | TimedTick
    | TimerToggled of bool
        
let timerCmd = 
    async { do! Async.Sleep 200
            return TimedTick }
    |&gt; Cmd.ofAsyncMsg

let init () = { TimerOn = false; Count = 0; Step = 1 }, Cmd.none
    
let update msg model =
    match msg with
    | TimerToggled on -&gt; { model with TimerOn = on }, (if on then timerCmd else Cmd.none)
    | TimedTick -&gt; if model.TimerOn then { model with Count = model.Count + model.Step }, timerCmd else model, Cmd.none
</code></pre><h2 id=triggering-commands-from-external-events>Triggering Commands from External Events <a href=#triggering-commands-from-external-events class=anchor aria-hidden=true>#</a></h2><p>You can also set up global subscriptions, which are events sent from outside the view or the dispatch loop. For example, dispatching <code>ClockMsg</code> messages on a global timer:</p><pre><code class=language-fs>let timerTick dispatch =
    let timer = new System.Timers.Timer(1.0)
    timer.Elapsed.Subscribe (fun _ -&gt; dispatch (ClockMsg System.DateTime.Now)) |&gt; ignore
    timer.Enabled &lt;- true
    timer.Start()

let runner = 
    Program.mkSimple App.init App.update App.view
    |&gt; Program.withSubscription (fun _ -&gt; Cmd.ofSub timerTick)
    |&gt; Program.runWithDynamicView app
</code></pre><p>Likewise, the general pattern to subscribe to external event sources is as follows:</p><pre><code class=language-fs>let subscribeToPushEvent dispatch = 
     ...
     call dispatch in some closure
     ...

let runner = 
    Program.mkSimple App.init App.update App.view
    |&gt; Program.withSubscription (fun _ -&gt; Cmd.ofSub subscribeToPushEvent)
    |&gt; Program.runWithDynamicView app
</code></pre><p>Everything that wants access to <code>dispatch</code> must be mentioned in the composition of the overall app, or as part of a command produced as a result of processing a message, or in the view.</p><h2 id=replacing-commands-with-command-messages-for-better-testability>Replacing commands with command messages for better testability <a href=#replacing-commands-with-command-messages-for-better-testability class=anchor aria-hidden=true>#</a></h2><p>Commands are a great way for executing a set of tasks (asynchronous or not) after receiving a message.</p><p>But behind the scenes, <code>Cmd&lt;'msg></code> is really only an array of functions. This makes testing <code>Cmd&lt;'msg></code> really difficult (no way to know what the functions are) and the functions <code>init</code> and <code>update</code> as well.</p><p>In the case you want to unit test your code, even if you&rsquo;re using <code>Cmd&lt;'msg></code> inside <code>init</code> and <code>update</code>, the best way is to use of the <code>CmdMsg</code> pattern.</p><p>This is a general pattern, applicable when using an Elm-like programming model.<br>It is not linked to Fabulous specifically.</p><p>Fabulous only provides some helpers to help you achieve this with less code.</p><p>The principle is to replace any direct usage of <code>Cmd&lt;'msg></code> from <code>init</code> and <code>update</code>, and instead use a discriminated union called <code>CmdMsg</code>.</p><pre><code class=language-fs>type Model = 
    { TimerOn: bool
      Count: int
      Step: int }
        
type Msg = 
    | TimedTick
    | TimerToggled of bool

type CmdMsg =
    | TimerTick

let init () =
    { TimerOn = false; Count = 0; Step = 1 }, [] // An empty list means no action
    
let update msg model =
    match msg with
    | TimerToggled on -&gt;
       { model with TimerOn = on }, [ if on then yield TimerTick ]
    | TimedTick -&gt;
       if model.TimerOn then
          { model with Count = model.Count + model.Step }, [ TimerTick ]
       else
          model, []
</code></pre><p>Doing this transforms the output of both <code>init</code> and <code>update</code> to pure data output, which can then be easily unit tested</p><pre><code class=language-fs>[&lt;Test&gt;]
let togglingOnShouldTriggerTimerTick () =
    let initialModel = { TimerOn = false; Count = 0; Step = 1 }
    let expectedReturn = { TimerOn = true; Count = 0; Step = 1 }, [ TimerTick ]
    App.update (TimerToggled true) initialModel |&gt; should equal expectedReturn
</code></pre><p>The actual commands are still executed as <code>Cmd&lt;'msg></code> though.<br>So in order to make this work with Fabulous, you need a function that will convert a <code>CmdMsg</code> to a <code>Cmd&lt;'msg></code></p><p>Fabulous then helps you boot your application using <code>Program.mkProgramWithCmdMsg</code></p><pre><code class=language-fs>let mapCommands cmdMsg =
    match cmdMsg with
    | TimerTick -&gt; timerCmd()

type App() as app =
    inherit Application()

    let runner =
        Program.mkProgramWithCmdMsg init update view mapCommands
        |&gt; XamarinFormsProgram.run app
</code></pre><p>Note that <code>Program.mkProgramWithCmdMsg</code> doesn&rsquo;t do anything magic.<br>It only applies <code>mapCommands</code> to any <code>CmdMsg</code> returned by <code>init</code> and <code>update</code>.<br>You could achieve the exact same behavior by converting them yourself and using <code>Program.mkProgram</code>.</p><h2 id=threading-and-long-running-operations>Threading and Long-running Operations <a href=#threading-and-long-running-operations class=anchor aria-hidden=true>#</a></h2><p>The rules:</p><ol><li><code>update</code> gets run on the UI thread.</li><li><code>dispatch</code> can be called from any thread. The message will be processed by <code>update</code> on the UI thread.</li><li><code>view</code> gets called on the UI thread. In the future an option may be added to offload the <code>view</code> function automatically.</li></ol><p>When handling any long running operation, the operation should initiate it&rsquo;s thing and dispatch a message when done.
If necessary, explicitly off-load and then dispatch at the end, e.g.</p><pre><code class=language-fs>let backgroundCmd =
    Cmd.ofAsyncMsg (async { 
        do! Async.SwitchToThreadPool()
        let res = ...
        return msg
    })
</code></pre><h2 id=optional-commands>Optional commands <a href=#optional-commands class=anchor aria-hidden=true>#</a></h2><p>There might be cases where before a message is sent, you need to check if you want to send it (e.g. check user&rsquo;s preferences, ask user&rsquo;s permission, &mldr;)</p><p>Fabulous has 2 helper functions for this:</p><ul><li><code>Cmd.ofMsgOption</code></li></ul><pre><code class=language-fs>let autoSaveCmd =
    match userPreference.IsAutoSaveEnabled with
    | false -&gt; None
    | true -&gt;
        autoSave()
        Some Msg.AutoSaveDone

let update msg model =
    match msg with
    | TimedTick -&gt; model, (Cmd.ofMsgOption autoSaveCmd)
    | AutoSaveDone -&gt; ...
</code></pre><ul><li><code>Cmd.ofAsyncMsgOption</code></li></ul><pre><code class=language-fs>let takePictureCmd = async {
    try
        let! picture = takePictureAsync()
        Some (Msg.PictureTaken picture)
    with
    | exn -&gt;
        do! displayAlert(&quot;Exception: &quot; + exn.Message)
        None
}

let update msg model =
    match msg with
    | TakePicture -&gt; model, (Cmd.ofAsyncMsgOption takePictureCmd)
    | PictureTaken -&gt; ...
</code></pre><h2 id=webrequests-in-a-command>Webrequests in a Command <a href=#webrequests-in-a-command class=anchor aria-hidden=true>#</a></h2><p>Sometimes it is needed to make some web requests. Which tool you use here does not matter. For example you could use FSharp.Data to make HttpRequests.
These are the steps that you have to do, to make it work:</p><ol><li>Create a case in the message type for a successful and failure webrequests</li></ol><pre><code class=language-fs>type Msg =
    | LoginClicked
    | LoginSuccess
    | AuthError
</code></pre><ol><li>Implement the Command and return the correct message</li></ol><pre><code class=language-fs>let authUser (username : string) (password : string) =
    async {
        do! Async.SwitchToThreadPool()
        // make your http call
        // FSharp.Data.HTTPUtil is used here
        let! response = Http.AsyncRequest
                            (url = URL, body = TextRequest &quot;&quot;&quot; {&quot;username&quot;: &quot;test&quot;, &quot;password&quot;: &quot;testpassword&quot;} &quot;&quot;&quot;,
                             httpMethod = &quot;POST&quot;, silentHttpErrors = true)
        let r =
            match response.StatusCode with
            | 200 -&gt; LoginSuccess
            | _ -&gt; AuthError
        return r
    }
    |&gt; Cmd.ofAsyncMsg
</code></pre><ol><li>Call the Command from update e.g. when a button is clicked</li></ol><pre><code class=language-fs>let update msg model =
    match msg with
    | LoginClicked -&gt; { model with IsRunning = true }, authUser model.Username model.Password // Call the Command
    | LoginSuccess -&gt;
        { model with IsLoggedIn = true
                     IsRunning = false }, Cmd.none
    | AuthError -&gt;
        { model with IsLoggedIn = false
                     IsRunning = false }, Cmd.none
</code></pre><ol><li>Create your view as you need</li></ol><pre><code class=language-fs>match model.IsLoggedIn with
| true -&gt; LoggedInSuccesful
| false -&gt; LoginView
</code></pre><h2 id=platform-specific-dispatch>Platform-specific dispatch <a href=#platform-specific-dispatch class=anchor aria-hidden=true>#</a></h2><p>Some platform-specific features (like deep linking, memory warnings, &mldr;) are not available in Xamarin.Forms, and need you to implement them in the corresponding app projet.<br>In this case, you might want to dispatch a message from the app project to Fabulous to start a shared logic between platforms (to warn user, &mldr;).</p><p>To allow for this kind of use case, the <code>dispatch</code> function is exposed as a <code>Dispatch(msg)</code> method by the <code>ProgramRunner</code>. By default this runner is not accessible, but you can make a read-only property to let apps access it.</p><pre><code class=language-fs>type App() as app =
    inherit Application()

    let runner =
        Program.mkProgram init update view
        |&gt; XamarinFormsProgram.run app

    member __.Program = runner // Add this line
</code></pre><p>Once done, you can access it in the app project</p><ul><li>Android</li></ul><pre><code class=language-fs>[&lt;Activity&gt;]
type MainActivity() =
    inherit FormsApplicationActivity()

    // Store the App instance
    let mutable _app: App option = None

    override this.OnCreate (bundle: Bundle) =
        base.OnCreate (bundle)

        Forms.Init (this, bundle)

        // Initialize the app and store its reference
        let app = new App()
        this.LoadApplication(app)
        _app &lt;- Some app

    override this.OnTrimMemory(level) =
        // If the app is initialized, dispatch the message
        match _app with
        | Some app -&gt; app.Program.Dispatch(Msg.ReceivedLowMemoryWarning)
        | None -&gt; ()
</code></pre><ul><li>iOS</li></ul><pre><code class=language-fs>[&lt;Register(&quot;AppDelegate&quot;)&gt;]
type AppDelegate () =
    inherit FormsApplicationDelegate ()

    // Store the App instance
    let mutable _app: App option = None

    override this.FinishedLaunching (uiApp, options) =
        Forms.Init()

        // Initialize the app and store its reference
        let app = new AllControls.App()
        this.LoadApplication (app)
        _app &lt;- Some app

        base.FinishedLaunching(uiApp, options)

    override this.ReceiveMemoryWarning(uiApp) =
        // If the app is initialized, dispatch the message
        match _app with
        | Some app -&gt; app.Program.Dispatch(Msg.ReceivedLowMemoryWarning)
        | None -&gt; ()
</code></pre><div class="page-footer-meta d-flex flex-column flex-md-row justify-content-between"><div class=edit-page><a href=https://github.com/TimLariviere/Fabulous-new/blob/main/docs/content/en/docs/v1/tutorials/update.md><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-edit-2"><path d="M17 3a2.828 2.828.0 114 4L7.5 20.5 2 22l1.5-5.5L17 3z"/></svg>Edit this page on GitHub</a></div></div><div class="docs-navigation d-flex justify-content-between"><a href=https://fsprojects.github.io/Fabulous/docs/v1/tutorials/dev-testing/><div class="card my-1"><div class="card-body py-2">&larr; Testing</div></div></a><a class=ms-auto href=https://fsprojects.github.io/Fabulous/docs/v1/api/controls/timepicker/><div class="card my-1"><div class="card-body py-2">TimePicker &rarr;</div></div></a></div></main></div></div></div><footer class="footer text-muted"><div class=container-xxl><div class=row><div class="col-lg-8 order-last order-lg-first"><ul class=list-inline><li class=list-inline-item>Powered by <a class=text-muted href=https://pages.github.com>GitHub Pages</a>, <a class=text-muted href=https://gohugo.io/>Hugo</a>, and <a class=text-muted href=https://getdoks.org/>Doks</a></li></ul></div><div class="col-lg-8 order-first order-lg-last text-lg-end"><ul class=list-inline></ul></div></div></div></footer><script src=https://fsprojects.github.io/Fabulous/js/bootstrap.min.fdbe9b9ba88a036135318f3c721784d684ac9e3280fe282cc80d7d49f7f9c82780cd54228c1608685a230c09984300d7946fc471734d566fcebc148b65bd16db.js integrity="sha512-/b6bm6iKA2E1MY88cheE1oSsnjKA/igsyA19Sff5yCeAzVQijBYIaFojDAmYQwDXlG/EcXNNVm/OvBSLZb0W2w==" crossorigin=anonymous defer></script>
<script src=https://fsprojects.github.io/Fabulous/js/highlight.min.838b3c1ddbb9b9165b7561f7099cb5c4355b6154aaeb65308b36bab9eb30eaa5878166aa717b399c4adddd7dd2a4e04efa14a096b190683a94630bb0c15b431e.js integrity="sha512-g4s8Hdu5uRZbdWH3CZy1xDVbYVSq62Uwiza6uesw6qWHgWaqcXs5nErd3X3SpOBO+hSglrGQaDqUYwuwwVtDHg==" crossorigin=anonymous defer></script>
<script src=https://fsprojects.github.io/Fabulous/main.min.6bcd117899ffc9e0f284a6a38e48794689fd80fbd8a0a50a6c886e47e1bfac6c90f39ecad7cdc1a52f577e7c99ed379a3b3b84adb674a5776d815dd650d71eb6.js integrity="sha512-a80ReJn/yeDyhKajjkh5Ron9gPvYoKUKbIhuR+G/rGyQ857K183BpS9XfnyZ7TeaOzuErbZ0pXdtgV3WUNcetg==" crossorigin=anonymous defer></script>
<script src=https://fsprojects.github.io/Fabulous/index.min.2f6a8dc3f2dc07473d6fd035b26f9a7a247bdbdc7f6cca3ed72c75b8bf9d928d53138ae17340bd2d451eef0b84a80b7e967fa55f67c559f300dfb591c4602444.js integrity="sha512-L2qNw/LcB0c9b9A1sm+aeiR729x/bMo+1yx1uL+dko1TE4rhc0C9LUUe7wuEqAt+ln+lX2fFWfMA37WRxGAkRA==" crossorigin=anonymous defer></script></body></html>