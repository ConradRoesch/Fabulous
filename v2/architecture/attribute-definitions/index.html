<!doctype html><html lang=en-us><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="ie=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><link rel=preload as=font href=https://docs.fabulous.dev/fonts/vendor/jost/jost-v4-latin-regular.woff2 type=font/woff2 crossorigin><link rel=preload as=font href=https://docs.fabulous.dev/fonts/vendor/jost/jost-v4-latin-500.woff2 type=font/woff2 crossorigin><link rel=preload as=font href=https://docs.fabulous.dev/fonts/vendor/jost/jost-v4-latin-700.woff2 type=font/woff2 crossorigin><script>(()=>{var b=window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches,a=localStorage.getItem("theme");b&&a===null&&(localStorage.setItem("theme","dark"),document.documentElement.setAttribute("data-dark-mode","")),b&&a==="dark"&&document.documentElement.setAttribute("data-dark-mode",""),a==="dark"&&document.documentElement.setAttribute("data-dark-mode","")})()</script><link rel=stylesheet href=https://docs.fabulous.dev/main.6600c3b63112594832a975028011a6ba21205542b563b84baf571dbcbd9b3606939979a1041079499a21a0386c0dc97bd489a25bd5a3ca3e126ff971a7cb00cc.css integrity="sha512-ZgDDtjESWUgyqXUCgBGmuiEgVUK1Y7hLr1cdvL2bNgaTmXmhBBB5SZohoDhsDcl71ImiW9Wjyj4Sb/lxp8sAzA==" crossorigin=anonymous><noscript><style>img.lazyload{display:none}</style></noscript><meta name=robots content="index, follow"><meta name=googlebot content="index, follow, max-snippet:-1, max-image-preview:large, max-video-preview:-1"><meta name=bingbot content="index, follow, max-snippet:-1, max-image-preview:large, max-video-preview:-1"><title>Attribute definitions - Fabulous</title><meta name=description content="Attribute definition helpers # defineBindableWithEvent (Xamarin.Forms) # Values and event handlers are very similar. They are both values: one has a concrete value, the other has a function value. That&amp;rsquo;s why in v2, values and events are both treated as individual scalar attributes.
That works most of the time, but some properties and events have a strong dependency. E.g.:
 Entry: Text / TextChanged Slider: Value / ValueChanged ListView: SelectedIndex / SelectedIndex  This is required to be able to react to user interactions like users are inputting text, toggling a switch, etc."><link rel=canonical href=https://docs.fabulous.dev/v2/architecture/attribute-definitions/><meta property="og:locale" content="en_US"><meta property="og:type" content="article"><meta property="og:title" content="Attribute definitions"><meta property="og:description" content="Attribute definition helpers # defineBindableWithEvent (Xamarin.Forms) # Values and event handlers are very similar. They are both values: one has a concrete value, the other has a function value. That&rsquo;s why in v2, values and events are both treated as individual scalar attributes.
That works most of the time, but some properties and events have a strong dependency. E.g.:
 Entry: Text / TextChanged Slider: Value / ValueChanged ListView: SelectedIndex / SelectedIndex  This is required to be able to react to user interactions like users are inputting text, toggling a switch, etc."><meta property="og:url" content="https://docs.fabulous.dev/v2/architecture/attribute-definitions/"><meta property="og:site_name" content="Fabulous"><meta property="article:published_time" content="2022-04-21T00:00:00+00:00"><meta property="article:modified_time" content="2022-04-21T00:00:00+00:00"><meta property="og:image" content="https://docs.fabulous.dev/fabulous.png"><meta property="og:image:alt" content="Fabulous"><meta name=twitter:card content="summary_large_image"><meta name=twitter:site content="@Tim_Lariviere"><meta name=twitter:creator content="@Tim_Lariviere"><meta name=twitter:title content="Attribute definitions"><meta name=twitter:description content><meta name=twitter:image content="https://docs.fabulous.dev/fabulous.png"><meta name=twitter:image:alt content="Attribute definitions"><script type=application/ld+json>{"@context":"https://schema.org","@graph":[{"@type":"Organization","@id":"https://docs.fabulous.dev/#/schema/organization/1","name":"Fabulous","url":"https://docs.fabulous.dev/","sameAs":["https://twitter.com/Tim_Lariviere","https://github.com/fsprojects/Fabulous"],"logo":{"@type":"ImageObject","@id":"https://docs.fabulous.dev/#/schema/image/1","url":"https://docs.fabulous.dev/logo-fabulous.png","width":512,"height":512,"caption":"Fabulous"},"image":{"@id":"https://docs.fabulous.dev/#/schema/image/1"}},{"@type":"WebSite","@id":"https://docs.fabulous.dev/#/schema/website/1","url":"https://docs.fabulous.dev/","name":"Fabulous","description":"Fabulous allows you to combine the power of functional programming and the simple Model-View-Update architecture to build any kind of mobile and desktop applications with an expressive, dynamic and clean UI DSL.","publisher":{"@id":"https://docs.fabulous.dev/#/schema/organization/1"}},{"@type":"WebPage","@id":"https://docs.fabulous.dev/v2/architecture/attribute-definitions/","url":"https://docs.fabulous.dev/v2/architecture/attribute-definitions/","name":"Attribute definitions","description":"","isPartOf":{"@id":"https://docs.fabulous.dev/#/schema/website/1"},"about":{"@id":"https://docs.fabulous.dev/#/schema/organization/1"},"datePublished":"2022-04-21T00:00:00CET","dateModified":"2022-04-21T00:00:00CET","breadcrumb":{"@id":"https://docs.fabulous.dev/v2/architecture/attribute-definitions/#/schema/breadcrumb/1"},"primaryImageOfPage":{"@id":"https://docs.fabulous.dev/v2/architecture/attribute-definitions/#/schema/image/2"},"inLanguage":"en-US","potentialAction":[{"@type":"ReadAction","target":["https://docs.fabulous.dev/v2/architecture/attribute-definitions/"]}]},{"@type":"BreadcrumbList","@id":"https://docs.fabulous.dev/v2/architecture/attribute-definitions/#/schema/breadcrumb/1","name":"Breadcrumbs","itemListElement":[{"@type":"ListItem","position":1,"item":{"@type":"WebPage","@id":"https://docs.fabulous.dev/","url":"https://docs.fabulous.dev/","name":"Home"}},{"@type":"ListItem","position":2,"item":{"@type":"WebPage","@id":"https://docs.fabulous.dev/v2/","url":"https://docs.fabulous.dev/v2/","name":"V2"}},{"@type":"ListItem","position":3,"item":{"@type":"WebPage","@id":"https://docs.fabulous.dev/v2/architecture/","url":"https://docs.fabulous.dev/v2/architecture/","name":"Architecture"}},{"@type":"ListItem","position":4,"item":{"@id":"https://docs.fabulous.dev/v2/architecture/attribute-definitions/"}}]},{"@context":"https://schema.org","@graph":[{"@type":"ImageObject","@id":"https://docs.fabulous.dev/v2/architecture/attribute-definitions/#/schema/image/2","url":"https://docs.fabulous.dev/fabulous.png","contentUrl":"https://docs.fabulous.dev/fabulous.png","caption":"Attribute definitions"}]}]}</script><meta name=theme-color content="#fff"><link rel=apple-touch-icon sizes=180x180 href=https://docs.fabulous.dev/apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=https://docs.fabulous.dev/favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=https://docs.fabulous.dev/favicon-16x16.png><link rel=manifest crossorigin=use-credentials href=https://docs.fabulous.dev/site.webmanifest></head><body class="v2 single"><div class=header-bar></div><header class="navbar navbar-expand-md navbar-light doks-navbar"><nav class="container-xxl flex-wrap flex-md-nowrap" aria-label="Main navigation"><a class="navbar-brand p-0 me-auto" href=https://docs.fabulous.dev/ aria-label=Fabulous>Fabulous</a>
<button class="btn btn-menu d-block d-md-none order-5" type=button data-bs-toggle=offcanvas data-bs-target=#offcanvasDoks aria-controls=offcanvasDoks aria-label="Open main menu"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-menu"><line x1="3" y1="12" x2="21" y2="12"/><line x1="3" y1="6" x2="21" y2="6"/><line x1="3" y1="18" x2="21" y2="18"/></svg></button><div class="offcanvas offcanvas-start border-0 py-md-1" tabindex=-1 id=offcanvasDoks data-bs-backdrop=true aria-labelledby=offcanvasDoksLabel><div class="header-bar d-md-none"></div><div class="offcanvas-header d-md-none"><h2 class="h5 offcanvas-title ps-2" id=offcanvasDoksLabel><a class=text-dark href=https://docs.fabulous.dev/>Fabulous</a></h2><button type=button class="btn-close text-reset me-2" data-bs-dismiss=offcanvas aria-label="Close main menu"></button></div><div class="offcanvas-body px-4"><h3 class="h6 text-uppercase mb-3 d-md-none">Main</h3><ul class="nav flex-column flex-md-row ms-md-n3"><li class=nav-item><a class="nav-link ps-0 py-1" href=https://docs.fabulous.dev>Docs</a></li></ul><hr class="text-black-50 my-4 d-md-none"><h3 class="h6 text-uppercase mb-3 d-md-none">Socials</h3><ul class="nav flex-column flex-md-row ms-md-auto me-md-n5 pe-md-2"><li class=nav-item><a class="nav-link ps-0 py-1" href=https://github.com/fsprojects/Fabulous><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-github"><path d="M9 19c-5 1.5-5-2.5-7-3m14 6v-3.87a3.37 3.37.0 00-.94-2.61c3.14-.35 6.44-1.54 6.44-7A5.44 5.44.0 0020 4.77 5.07 5.07.0 0019.91 1S18.73.65 16 2.48a13.38 13.38.0 00-7 0C6.27.65 5.09 1 5.09 1A5.07 5.07.0 005 4.77 5.44 5.44.0 003.5 8.55c0 5.42 3.3 6.61 6.44 7A3.37 3.37.0 009 18.13V22"/></svg><small class="ms-2 d-md-none">GitHub</small></a></li><li class=nav-item><a class="nav-link ps-0 py-1" href=https://twitter.com/Tim_Lariviere><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-twitter"><path d="M23 3a10.9 10.9.0 01-3.14 1.53 4.48 4.48.0 00-7.86 3v1A10.66 10.66.0 013 4s-4 9 5 13a11.64 11.64.0 01-7 2c9 5 20 0 20-11.5a4.5 4.5.0 00-.08-.83A7.72 7.72.0 0023 3z"/></svg><small class="ms-2 d-md-none">Twitter</small></a></li></ul></div></div><button id=mode class="btn btn-link order-md-1" type=button aria-label="Toggle user interface mode">
<span class=toggle-dark><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-moon"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg></span><span class=toggle-light><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-sun"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></span></button></nav></header><nav class="doks-subnavbar py-2 sticky-lg-top d-lg-none" aria-label="Secondary navigation"><div class="container-xxl d-flex align-items-md-center"><span class="navbar-text ms-0">V2</span>
<button class="btn doks-sidebar-toggle d-lg-none ms-auto order-3 collapsed" type=button data-bs-toggle=collapse data-bs-target=#doks-docs-nav aria-controls=doks-docs-nav aria-expanded=false aria-label="Toggle documentation navigation"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" class="doks doks-expand" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><title>Expand</title><polyline points="7 13 12 18 17 13"/><polyline points="7 6 12 11 17 6"/></svg><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" class="doks doks-collapse" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><title>Collapse</title><polyline points="17 11 12 6 7 11"/><polyline points="17 18 12 13 7 18"/></svg></button></div></nav><div class=container-xxl><aside class=doks-sidebar><nav id=doks-docs-nav class="collapse d-lg-none" aria-label="Tertiary navigation"><ul class="list-unstyled collapsible-sidebar"></ul></nav></aside></div><div class="wrap container-xxl" role=document><div class=content><div class="row flex-xl-nowrap"><div class="col-lg-5 col-xl-4 docs-sidebar d-none d-lg-block"><nav class=docs-links aria-label="Main navigation"><ul class="list-unstyled collapsible-sidebar"></ul></nav></div><nav class="docs-toc d-none d-xl-block col-xl-3" aria-label="Secondary navigation"><div class=page-links><h3>On this page</h3><nav id=TableOfContents><ul><li><a href=#attribute-definition-helpers>Attribute definition helpers</a><ul><li><a href=#definebindablewithevent-xamarinforms>defineBindableWithEvent (Xamarin.Forms)</a></li></ul></li></ul></nav></div></nav><main class="docs-content col-lg-11 col-xl-9"><h1>Attribute definitions</h1><p class=lead></p><nav class=d-xl-none aria-label="Quaternary navigation"><div class=page-links><h3>On this page</h3><nav id=TableOfContents><ul><li><a href=#attribute-definition-helpers>Attribute definition helpers</a><ul><li><a href=#definebindablewithevent-xamarinforms>defineBindableWithEvent (Xamarin.Forms)</a></li></ul></li></ul></nav></div></nav><h2 id=attribute-definition-helpers>Attribute definition helpers <a href=#attribute-definition-helpers class=anchor aria-hidden=true>#</a></h2><h3 id=definebindablewithevent-xamarinforms>defineBindableWithEvent (Xamarin.Forms) <a href=#definebindablewithevent-xamarinforms class=anchor aria-hidden=true>#</a></h3><p>Values and event handlers are very similar. They are both values: one has a concrete value, the other has a function value.
That&rsquo;s why in v2, values and events are both treated as individual scalar attributes.</p><p>That works most of the time, but some properties and events have a strong dependency.
E.g.:</p><ul><li>Entry: Text / TextChanged</li><li>Slider: Value / ValueChanged</li><li>ListView: SelectedIndex / SelectedIndex</li></ul><p>This is required to be able to react to user interactions like users are inputting text, toggling a switch, etc.
But in Xamarin.Forms, those events are also triggered by programmatic changes.</p><p>If you, as a developer, decides to toggle the switch from false to true, it will raise a <code>Toggled</code> event - the same event if the users had toggle the switch themselves.</p><p>Firstly this makes it hard to differentiate if we are reacting to a user change or a programmatic change.
The latter is not really interesting since we already know what&rsquo;s inside the app model.</p><p>This behavior seems rather harmless because in case of programmatic change, Fabulous will see that the event is actually trying to set the related property to the same value, so no change is needed.
Eg.: [Programmatic Change: Value = true] -> [Event msg: Value changed to true] -> [Value was true, now is true] -> [do nothing]</p><p>But on Android, this can lead to an infinite update loop.
Android delays its event triggering a little bit so if the user is quickly changing the input, Fabulous and Android can get out of sync and freeze the app.</p><p>Example: User wants to write &ldquo;Hello&rdquo;</p><ol><li>User taps letter <code>H</code></li><li>User taps letter <code>e</code></li><li>Android raises event &ldquo;TextChanged: H&rdquo; -> Fabulous will change the Entry&rsquo;s text to <code>H</code> (was <code>He</code>) -> triggering another event</li><li>Android raises event &ldquo;TextChanged: He&rdquo; -> Fabulous will change the Entry&rsquo;s text to <code>He</code> (was <code>H</code>)</li><li>Android raises event &ldquo;TextChanged: H&rdquo; (because of (3)) -> Fabulous will change to <code>H</code> (was <code>He</code>)</li><li>Android raises event &ldquo;TextChanged: He&rdquo; (because of (4)) -> Fabulous will change the Entry&rsquo;s text to <code>He</code> (was <code>H</code>)</li><li>etc.</li></ol><p>To avoid this from happening, the only way is to ignore the events triggered by programmatic changes.
This is done by removing the event handler before updating the value and reset it after.</p><p>To guarantee the order of execution, we need to handle both the property and the related event in a single attribute, where the <code>UpdateNode</code> function of the attribute will take care of updating in the right order.</p><ol><li>Remove old handler if any</li><li>Update the value (it will trigger an event, but we don&rsquo;t listen to it anymore)<ul><li>If attribute was removed, then we clean the old value</li><li>Otherwise we set the new value</li></ul></li><li>Set the new handler if any</li></ol><p>Here is the attribute declaration to use:</p><p>Before we had 2 attribute definitions (property and event)</p><pre><code class=language-fs>module Slider =
    let Value = Attributes.defineBindable&lt;float&gt; Slider.ValueProperty

    let ValueChanged =
        Attributes.defineEventWithArgs&lt;ValueChangedEventArgs&gt;
            &quot;Slider_ValueChanged&quot;
            (fun target -&gt; (target :?&gt; Slider).ValueChanged)

type Fabulous.XamarinForms.View with
    static member inline Slider&lt;'msg&gt;(value: float, onValueChanged: ValueChangedEventArgs -&gt; 'msg) =
        WidgetBuilder&lt;'msg, ISlider&gt;(
            Slider.WidgetKey,
            Slider.Value.WithValue(value),
            Slider.ValueChanged.WithValue(fun args -&gt; onValueChanged args |&gt; box)
        )
</code></pre><p>Now, there is a new attribute definition to update both the property and the event in a single attribute.</p><pre><code class=language-fs>module Slider =
    let ValueWithEvent =
        Attributes.defineBindableWithEvent&lt;float, ValueChangedEventArgs&gt;
            &quot;Slider_ValueChanged&quot;
            Slider.ValueProperty
            (fun target -&gt; (target :?&gt; Slider).ValueChanged)

type Fabulous.XamarinForms.View with
    static member inline Slider&lt;'msg&gt;(value: float, onValueChanged: ValueChangedEventArgs -&gt; 'msg) =
        WidgetBuilder&lt;'msg, ISlider&gt;(
            Slider.WidgetKey,
            Slider.ValueWithEvent.WithValue(ValueEventData.create value (fun args -&gt; onValueChanged args |&gt; box))
        )
</code></pre><div class="page-footer-meta d-flex flex-column flex-md-row justify-content-between"><div class=edit-page><a href=https://github.com/fsprojects/Fabulous/blob/main/docs/content/en/v2/architecture/attribute-definitions.md><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-edit-2"><path d="M17 3a2.828 2.828.0 114 4L7.5 20.5 2 22l1.5-5.5L17 3z"/></svg>Edit this page on GitHub</a></div></div><div class="docs-navigation d-flex justify-content-between"><a href=https://docs.fabulous.dev/v2/architecture/virtualized-collections/><div class="card my-1"><div class="card-body py-2">&larr; Virtualized collections</div></div></a><a class=ms-auto href=https://docs.fabulous.dev/v2/api/controls/date-picker/><div class="card my-1"><div class="card-body py-2">DatePicker &rarr;</div></div></a></div></main></div></div></div><footer class="footer text-muted"><div class=container-xxl><div class=row><div class="col-lg-8 order-last order-lg-first"><ul class=list-inline><li class=list-inline-item>Powered by <a class=text-muted href=https://pages.github.com>GitHub Pages</a>, <a class=text-muted href=https://gohugo.io/>Hugo</a>, and <a class=text-muted href=https://getdoks.org/>Doks</a></li></ul></div><div class="col-lg-8 order-first order-lg-last text-lg-end"><ul class=list-inline></ul></div></div></div></footer><script src=https://docs.fabulous.dev/js/bootstrap.min.fdbe9b9ba88a036135318f3c721784d684ac9e3280fe282cc80d7d49f7f9c82780cd54228c1608685a230c09984300d7946fc471734d566fcebc148b65bd16db.js integrity="sha512-/b6bm6iKA2E1MY88cheE1oSsnjKA/igsyA19Sff5yCeAzVQijBYIaFojDAmYQwDXlG/EcXNNVm/OvBSLZb0W2w==" crossorigin=anonymous defer></script>
<script src=https://docs.fabulous.dev/js/highlight.min.838b3c1ddbb9b9165b7561f7099cb5c4355b6154aaeb65308b36bab9eb30eaa5878166aa717b399c4adddd7dd2a4e04efa14a096b190683a94630bb0c15b431e.js integrity="sha512-g4s8Hdu5uRZbdWH3CZy1xDVbYVSq62Uwiza6uesw6qWHgWaqcXs5nErd3X3SpOBO+hSglrGQaDqUYwuwwVtDHg==" crossorigin=anonymous defer></script>
<script src=https://docs.fabulous.dev/main.min.6bcd117899ffc9e0f284a6a38e48794689fd80fbd8a0a50a6c886e47e1bfac6c90f39ecad7cdc1a52f577e7c99ed379a3b3b84adb674a5776d815dd650d71eb6.js integrity="sha512-a80ReJn/yeDyhKajjkh5Ron9gPvYoKUKbIhuR+G/rGyQ857K183BpS9XfnyZ7TeaOzuErbZ0pXdtgV3WUNcetg==" crossorigin=anonymous defer></script></body></html>